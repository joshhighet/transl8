(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5966:(e,t,a)=>{"use strict";a.d(t,{default:()=>L});var r=a(5155),s=a(2115),n=a(9708),o=a(2085),i=a(2596),l=a(9688);function d(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,l.QP)((0,i.$)(t))}let c=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function u(e){let{className:t,variant:a,size:s,asChild:o=!1,...i}=e,l=o?n.DX:"button";return(0,r.jsx)(l,{"data-slot":"button",className:d(c({variant:a,size:s,className:t})),...i})}function p(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card",className:d("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function x(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:d("leading-none font-semibold",t),...a})}function f(e){let{className:t,type:a,...s}=e;return(0,r.jsx)("input",{type:a,"data-slot":"input",className:d("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...s})}var m=a(1618),h=a(6474),v=a(5196),g=a(7863);function b(e){let{...t}=e;return(0,r.jsx)(m.bL,{"data-slot":"select",...t})}function j(e){let{...t}=e;return(0,r.jsx)(m.WT,{"data-slot":"select-value",...t})}function y(e){let{className:t,size:a="default",children:s,...n}=e;return(0,r.jsxs)(m.l9,{"data-slot":"select-trigger","data-size":a,className:d("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[s,(0,r.jsx)(m.In,{asChild:!0,children:(0,r.jsx)(h.A,{className:"size-4 opacity-50"})})]})}function w(e){let{className:t,children:a,position:s="popper",...n}=e;return(0,r.jsx)(m.ZL,{children:(0,r.jsxs)(m.UC,{"data-slot":"select-content",className:d("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...n,children:[(0,r.jsx)(N,{}),(0,r.jsx)(m.LM,{className:d("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,r.jsx)(z,{})]})})}function k(e){let{className:t,children:a,...s}=e;return(0,r.jsxs)(m.q7,{"data-slot":"select-item",className:d("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...s,children:[(0,r.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,r.jsx)(m.VF,{children:(0,r.jsx)(v.A,{className:"size-4"})})}),(0,r.jsx)(m.p4,{children:a})]})}function N(e){let{className:t,...a}=e;return(0,r.jsx)(m.PP,{"data-slot":"select-scroll-up-button",className:d("flex cursor-default items-center justify-center py-1",t),...a,children:(0,r.jsx)(g.A,{className:"size-4"})})}function z(e){let{className:t,...a}=e;return(0,r.jsx)(m.wn,{"data-slot":"select-scroll-down-button",className:d("flex cursor-default items-center justify-center py-1",t),...a,children:(0,r.jsx)(h.A,{className:"size-4"})})}var _=a(6538);function C(e){let{delayDuration:t=0,...a}=e;return(0,r.jsx)(_.Kq,{"data-slot":"tooltip-provider",delayDuration:t,...a})}function S(e){let{...t}=e;return(0,r.jsx)(C,{children:(0,r.jsx)(_.bL,{"data-slot":"tooltip",...t})})}function q(e){let{...t}=e;return(0,r.jsx)(_.l9,{"data-slot":"tooltip-trigger",...t})}function O(e){let{className:t,sideOffset:a=0,children:s,...n}=e;return(0,r.jsx)(_.ZL,{children:(0,r.jsxs)(_.UC,{"data-slot":"tooltip-content",sideOffset:a,className:d("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",t),...n,children:[s,(0,r.jsx)(_.i3,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}var U=a(5695),A=a(4126),P=a(4357),E=a(6766);let L=()=>{let[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)([]),[o,i]=(0,s.useState)({}),[l,d]=(0,s.useState)([]),c=(0,U.useSearchParams)(),m=(0,U.useRouter)(),h=(0,s.useCallback)(()=>{let e=[{keyword:"ip",value:"1.1.1.1"},{keyword:"port",value:"53",operator:"and"},{keyword:"country",value:"US",operator:"not"}];d(e);let t=new URLSearchParams;t.set("queries",JSON.stringify(e)),m.replace("?".concat(t.toString()),{scroll:!1})},[m]);(0,s.useEffect)(()=>{(async()=>{let[e,a,r]=await Promise.all([fetch("/data/queries.json"),fetch("/data/providers.json"),fetch("/data/countries.json")]);t(await e.json()),n(await a.json()),i(await r.json())})();let e=c.get("queries");if(e)try{d(JSON.parse(e))}catch(e){console.error("invalid URL query:",e),h()}else h()},[c,h]);let v=e=>{let t=l.filter((t,a)=>a!==e);d(t.length?t:[{keyword:"ip",value:""}]),N()},g=(e,t,a)=>{let r=[...l];"keyword"===t||"value"===t?r[e][t]=a:r[e].operator=a,d(r),N()},N=()=>{let e=new URLSearchParams,t=l.filter(e=>e.value.trim());t.length>0&&e.set("queries",JSON.stringify(t)),m.replace("?".concat(e.toString()),{scroll:!1})},z=a.map(t=>{let a=[],r=!0,s=new Set;for(let e of(l.forEach((e,t)=>{t>0&&e.operator&&s.add(e.operator)}),s))null===t["operators/".concat(e)]&&(a.push("Operator ".concat(e.toUpperCase())),r=!1);for(let{keyword:s,value:n}of l){let i=e.find(e=>e.keyword===s);i&&i[t.name]||(a.push(s),r=!1),n.trim()&&((null==i?void 0:i.constraint)&&!new RegExp(i.constraint).test(n)&&(a.push("".concat(s," (invalid value: ").concat(n,")")),r=!1),"quake360"!==t.name||"country"!==s||o[n.toUpperCase()]||(a.push("".concat(s," (invalid code: ").concat(n,")")),r=!1))}if(!r)return{provider:t,queryText:"",unavailable:!0,tooltip:"unsupported for ".concat(t.name,": ").concat(a.join(", "))};let n="";return l.forEach((a,r)=>{let{keyword:s,value:i,operator:l}=a;if(!i.trim())return;let d=e.find(e=>e.keyword===s),c=i;"asn"===s&&"TRUE"===t.as_includeprefix&&(c="AS".concat(i)),"quake360"===t.name&&"country"===s&&(c=o[i.toUpperCase()]);let u="freeform"===d[t.name]?'"'.concat(c,'"'):"".concat(d[t.name]).concat(t.kv_separator,'"').concat(c,'"');r>0&&(l&&"not"!==l&&t["operators/".concat(l)]?n+=" ".concat(t["operators/".concat(l)]," "):n+=t.query_separator||" "),"not"===l&&t["operators/not"]&&(u=t.name.includes("criminalip")?t["operators/not"]+u.replace(/"/g,""):"".concat(t["operators/not"]," ").concat(u)),n+=u}),{provider:t,queryText:n.trim(),unavailable:!1,tooltip:""}}).filter(e=>e.queryText||e.unavailable);return(0,r.jsxs)(C,{children:[(0,r.jsxs)("div",{className:"max-w-3xl mx-auto mb-8",children:[l.map((t,a)=>{let s=e.find(e=>e.keyword===t.keyword);return(0,r.jsxs)("div",{className:"flex items-center mb-4 space-x-2",children:[a>0&&(0,r.jsxs)(b,{value:t.operator||"and",onValueChange:e=>g(a,"operator",e),children:[(0,r.jsx)(y,{className:"w-[100px]",children:(0,r.jsx)(j,{})}),(0,r.jsxs)(w,{children:[(0,r.jsx)(k,{value:"and",children:"AND"}),(0,r.jsx)(k,{value:"or",children:"OR"}),(0,r.jsx)(k,{value:"not",children:"NOT"})]})]}),(0,r.jsxs)(b,{value:t.keyword,onValueChange:e=>g(a,"keyword",e),children:[(0,r.jsx)(y,{className:"w-[180px]",children:(0,r.jsx)(j,{placeholder:"select keyword"})}),(0,r.jsx)(w,{children:e.map(e=>(0,r.jsx)(k,{value:e.keyword,children:e.keyword},e.keyword))})]}),"country"===t.keyword?(0,r.jsxs)(b,{value:t.value,onValueChange:e=>g(a,"value",e),children:[(0,r.jsx)(y,{className:"flex-1",children:(0,r.jsx)(j,{placeholder:"select country"})}),(0,r.jsx)(w,{children:Object.entries(o).map(e=>{let[t,a]=e;return(0,r.jsxs)(k,{value:t,children:[a," (",t,")"]},t)})})]}):(0,r.jsx)(f,{value:t.value,onChange:e=>g(a,"value",e.target.value),placeholder:(null==s?void 0:s.example)||"enter value",className:"flex-1"}),(0,r.jsx)(u,{variant:"ghost",onClick:()=>v(a),size:"icon",children:(0,r.jsx)(A.A,{className:"h-4 w-4"})}),(null==s?void 0:s.description)&&(0,r.jsx)("span",{className:"text-sm text-gray-500 italic ml-2",children:s.description})]},a)}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)(u,{onClick:()=>{d([...l,{keyword:"ip",value:"",operator:"and"}]),N()},children:"add element"}),(0,r.jsx)(u,{variant:"outline",onClick:()=>{d([{keyword:"ip",value:""}]),N()},children:"clear all"})]})]}),(0,r.jsx)("div",{className:"flex flex-col space-y-2 max-w-4xl mx-auto",children:z.map(e=>{let{provider:t,queryText:a,unavailable:s,tooltip:n}=e;return(0,r.jsx)(p,{className:"p-2 ".concat(s?"opacity-50":""),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 min-w-[150px]",children:[(0,r.jsx)("a",{href:t.docs,target:"_blank",rel:"noopener noreferrer",children:(0,r.jsx)(E.default,{src:t.png_uri,alt:"".concat(t.name," logo"),width:24,height:24,className:"w-6 h-6"})}),(0,r.jsx)(x,{className:"text-sm font-medium",children:t.name})]}),(0,r.jsx)("div",{className:"flex-1 mx-4",children:s?(0,r.jsx)("p",{className:"font-mono text-xs bg-gray-200 text-red-600 px-2 py-1 rounded overflow-x-auto whitespace-nowrap",children:n}):(0,r.jsx)("p",{className:"font-mono text-xs bg-black text-cyan-400 px-2 py-1 rounded overflow-x-auto whitespace-nowrap",children:a})}),!s&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)(S,{children:[(0,r.jsx)(q,{asChild:!0,children:(0,r.jsx)(u,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>{navigator.clipboard?navigator.clipboard.writeText(a).catch(e=>{console.error("failed to copy: ",e),alert("copy to clipboard failed.")}):alert("clipboard API unavailable.")},children:(0,r.jsx)(P.A,{className:"h-3 w-3"})})}),(0,r.jsx)(O,{children:"Copy to clipboard"})]}),(0,r.jsx)(u,{size:"sm",className:"text-xs h-6",onClick:()=>{let e="fofa"===t.name?btoa(a):encodeURIComponent(a);window.open("".concat(t.prefix).concat(e),"_blank")},children:"Open"})]})]})},t.name)})})]})}},7353:(e,t,a)=>{Promise.resolve().then(a.bind(a,5966))}},e=>{var t=t=>e(e.s=t);e.O(0,[537,441,684,358],()=>t(7353)),_N_E=e.O()}]);